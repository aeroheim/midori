(()=>{"use strict";var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t,e){if(null==t)return{};var n,i,o=function(t,e){if(null==t)return{};var n,i,o={},r=Object.keys(t);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)n=r[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t.r(e),t.d(e,{Background:()=>lt,BackgroundCamera:()=>U,BackgroundEffects:()=>at,BackgroundRenderer:()=>Dt,Easings:()=>Tt,EffectPass:()=>st,EffectType:()=>N,Particles:()=>ct,SlideDirection:()=>vt,TransitionType:()=>mt,WipeDirection:()=>ht,isWebGLSupported:()=>Ot,loadImage:()=>Pt});const a=require("three"),u=require("three/examples/jsm/postprocessing/EffectComposer"),f=require("three/examples/jsm/WebGL");var c,l={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-l.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*l.Bounce.In(2*t):.5*l.Bounce.Out(2*t-1)+.5}}},h="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},d=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=h()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var o=this._tweens[n[i]],r=!e;o&&!1===o.update(t,r)&&!e&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),v={Linear:function(t,e){var n=t.length-1,i=n*e,o=Math.floor(i),r=v.Utils.Linear;return e<0?r(t[0],t[1],i):e>1?r(t[n],t[n-1],n-i):r(t[o],t[o+1>n?n:o+1],i-o)},Bezier:function(t,e){for(var n=0,i=t.length-1,o=Math.pow,r=v.Utils.Bernstein,s=0;s<=i;s++)n+=o(1-e,i-s)*o(e,s)*t[s]*r(i,s);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,o=Math.floor(i),r=v.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(o=Math.floor(i=n*(1+e))),r(t[(o-1+n)%n],t[o],t[(o+1)%n],t[(o+2)%n],i-o)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(r(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):r(t[o?o-1:0],t[o],t[n<o+1?n:o+1],t[n<o+2?n:o+2],i-o)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=v.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(c=[1],function(t){var e=1;if(c[t])return c[t];for(var n=t;n>1;n--)e*=n;return c[t]=e,e}),CatmullRom:function(t,e,n,i,o){var r=.5*(n-t),s=.5*(i-e),a=o*o;return(2*e-2*n+r+s)*(o*a)+(-3*e+3*n-2*r-s)*a+r*o+e}}},p=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),m=new d,_=function(){function t(t,e){void 0===e&&(e=m),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=l.Linear.None,this._interpolationFunction=v.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=p.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?h()+parseFloat(t):t:h(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,n,i){for(var o in n){var r=t[o],s=Array.isArray(r),a=s?"array":typeof r,u=!s&&Array.isArray(n[o]);if("undefined"!==a&&"function"!==a){if(u){var f=n[o];if(0===f.length)continue;f=f.map(this._handleRelativeValue.bind(this,r)),n[o]=[r].concat(f)}if("object"!==a&&!s||!r||u)void 0===e[o]&&(e[o]=r),s||(e[o]*=1),i[o]=u?n[o].slice().reverse():e[o]||0;else{for(var c in e[o]=s?[]:{},r)e[o][c]=r[c];i[o]=s?[]:{},this._setupProperties(r,e[o],n[o],i[o])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=h()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=h()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=h()),void 0===e&&(e=!0),this._isPaused)return!0;var n,i,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>o)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||i>1?1:i;var r=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,r),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,a=this._chainedTweens.length;s<a;s++)this._chainedTweens[s].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,n,i){for(var o in n)if(void 0!==e[o]){var r=e[o]||0,s=n[o],a=Array.isArray(t[o]),u=Array.isArray(s);!a&&u?t[o]=this._interpolationFunction(s,i):"object"==typeof s&&s?this._updateProperties(t[o],r,s,i):"number"==typeof(s=this._handleRelativeValue(r,s))&&(t[o]=r+(s-r)*i)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),g=(p.nextId,m),y=(g.getAll.bind(g),g.removeAll.bind(g),g.add.bind(g),g.remove.bind(g),g.update.bind(g));function b(t,e){return 2*Math.tan(a.MathUtils.degToRad(e.fov)/2)*t}function x(t,e){return b(t,e)*e.aspect}function w(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t>=e,o=i?t:e,r=i?e:t,s=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));if(r<=2*s*a*o||Math.abs(s-a)<1e-10){var u=.5*r;return{width:i?u/s:u/a,height:i?u/a:u/s}}var f=a*a-s*s;return{width:(t*a-e*s)/f,height:(e*a-t*s)/f}}function S(t,e,n){var i=t.geometry.parameters,o=w(i.width,i.height,n),r=o.width,s=o.height,u=2*Math.tan(a.MathUtils.degToRad(e.fov)/2),f=r/(u*e.aspect),c=s/u;return Math.min(f,c)+t.position.z}var U=function(){function t(e,n,o){i(this,t),s(this,"_plane",void 0),s(this,"camera",void 0),s(this,"_position",new a.Vector4(0,0,1,0)),s(this,"_positionOffset",new a.Vector4(0,0,0,0)),s(this,"_positionWithOffset",this._position.clone()),s(this,"_positionTransition",new _({x:0,y:0,z:0})),s(this,"_rotationTransition",new _({zr:0})),s(this,"_swayOffset",new a.Vector4(0,0,0,0)),s(this,"_swayTransition",new _({offsetX:0,offsetY:0,offsetZ:0,offsetZR:0})),this._plane=e,this.camera=new a.PerspectiveCamera(35,n/o,.001)}return r(t,[{key:"position",get:function(){var t=this._position;return{x:t.x,y:t.y,z:t.z,zr:t.w}}},{key:"positionOffset",get:function(){var t=this._positionOffset;return{x:t.x,y:t.y,z:t.z,zr:t.w}}},{key:"isMoving",value:function(){return this._positionTransition.isPlaying()}},{key:"isRotating",value:function(){return this._rotationTransition.isPlaying()}},{key:"isSwaying",value:function(){return this._swayTransition.isPlaying()}},{key:"setSize",value:function(t,e){this.camera.aspect=t/e,this.camera.updateProjectionMatrix()}},{key:"offset",value:function(t){var e=t.x,n=void 0===e?0:e,i=t.y,o=void 0===i?0:i,r=t.z,s=void 0===r?0:r,a=t.zr,u=void 0===a?0:a;this._positionOffset.set(n,o,s,u)}},{key:"sway",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("boolean"!=typeof t){this._swayTransition.stop();var i=n.loop,o=void 0!==i&&i,r=n.duration,s=void 0===r?0:r,u=n.delay,f=void 0===u?0:u,c=n.easing,h=void 0===c?l.Linear.None:c,d=n.onInit,v=void 0===d?function(){return{}}:d,p=n.onStart,m=void 0===p?function(){return{}}:p,g=n.onUpdate,y=void 0===g?function(){return{}}:g,b=n.onComplete,x=void 0===b?function(){return{}}:b,w=n.onStop,U=void 0===w?function(){return{}}:w,k=t.x,O=void 0===k?0:k,P=t.y,D=void 0===P?0:P,T=t.z,M=void 0===T?0:T,E=t.zr,B=void 0===E?0:E,z=a.MathUtils.degToRad(B),R=this._position.z/S(this._plane,this.camera,this.camera.rotation.z);v(),this._swayTransition=new _({offsetX:this._swayOffset.x,offsetY:this._swayOffset.y,offsetZ:this._swayOffset.z,offsetZR:this._swayOffset.w}).to({offsetX:-O+Math.random()*O*R,offsetY:-D+Math.random()*D*R,offsetZ:-M+Math.random()*M,offsetZR:-z+Math.random()*z},1e3*s).easing(h).onStart(m).onUpdate((function(t){var n=t.offsetX,i=t.offsetY,o=t.offsetZ,r=t.offsetZR;e._swayOffset.set(n,i,o,r),y()})).onComplete((function(){o&&e.sway(t,n),x()})).onStop(U).delay(1e3*f).start()}else t||this._swayTransition.stop()}},{key:"rotate",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("boolean"!=typeof t){this._rotationTransition.stop();var i=n.duration,o=void 0===i?0:i,r=n.delay,s=void 0===r?0:r,u=n.easing,f=void 0===u?l.Linear.None:u,c=n.onInit,h=void 0===c?function(){return{}}:c,d=n.onStart,v=void 0===d?function(){return{}}:d,p=n.onUpdate,m=void 0===p?function(){return{}}:p,g=n.onComplete,y=void 0===g?function(){return{}}:g,b=n.onStop,x=void 0===b?function(){return{}}:b,w=a.MathUtils.degToRad(t);h(),o>0||s>0?this._rotationTransition=new _({zr:this._position.w}).to({zr:w},1e3*o).easing(f).onStart(v).onUpdate((function(t){var n=t.zr;e._position.set(e._position.x,e._position.y,e._position.z,n),m()})).onComplete(y).onStop(x).delay(1e3*s).start():this._position.set(this._position.x,this._position.y,this._position.z,w)}else t||this._rotationTransition.stop()}},{key:"move",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("boolean"!=typeof t){this._positionTransition.stop();var i=this._position,o=i.x,r=i.y,s=i.z,a=t.x,u=void 0===a?o:a,f=t.y,c=void 0===f?r:f,h=t.z,d=void 0===h?s:h,v=n.duration,p=void 0===v?0:v,m=n.delay,g=void 0===m?0:m,y=n.easing,b=void 0===y?l.Linear.None:y,x=n.onInit,w=void 0===x?function(){return{}}:x,S=n.onStart,U=void 0===S?function(){return{}}:S,k=n.onUpdate,O=void 0===k?function(){return{}}:k,P=n.onComplete,D=void 0===P?function(){return{}}:P,T=n.onStop,M=void 0===T?function(){return{}}:T;w(),p>0?this._positionTransition=new _({x:o,y:r,z:s}).to({x:u,y:c,z:d},1e3*p).easing(b).onStart(U).onUpdate((function(t){var n=t.x,i=t.y,o=t.z;e._position.set(n,i,o,e._position.w),O()})).onComplete(D).onStop(M).delay(1e3*g).start():this._position.set(u,c,d,this._position.w)}else t||this._positionTransition.stop()}},{key:"update",value:function(){this._positionWithOffset.set(Math.min(1,Math.max(0,this._position.x+this._positionOffset.x+this._swayOffset.x)),Math.min(1,Math.max(0,this._position.y+this._positionOffset.y+this._swayOffset.y)),Math.min(1,.9*Math.max(0,this._position.z+this._positionOffset.z+this._swayOffset.z)+(1-.9)),this._position.w+a.MathUtils.degToRad(this._positionOffset.w)+this._swayOffset.w);var t=function(t,e,n){var i=n.x,o=n.y,r=n.z,s=n.w,u=function(t,e,n,i){var o=t.geometry.parameters,r=w(o.width,o.height,i),s=r.width,a=r.height,u=function(t,e,n,i){var o=n*S(t,e,i);return{width:x(o,e),height:b(o,e)}}(t,e,n,i);return{width:s-u.width,height:a-u.height}}(t,e,r,s),f=-u.width/2+i*u.width,c=u.height/2-o*u.height,l=S(t,e,s)*r;return new a.Vector4(f*Math.cos(s)-c*Math.sin(s),f*Math.sin(s)+c*Math.cos(s),l,s)}(this._plane,this.camera,this._positionWithOffset),e=t.x,n=t.y,i=t.z;this.camera.position.set(e,n,i),this.camera.rotation.z=this._position.w+a.MathUtils.degToRad(this._positionOffset.w)+this._swayOffset.w}},{key:"dispose",value:function(){this.sway(!1),this.move(!1),this.rotate(!1)}}]),t}();function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e,n){return(P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){if(e&&("object"===M(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return k(t)}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}const z=require("three/examples/jsm/postprocessing/Pass"),R=require("three/examples/jsm/shaders/CopyShader"),C=require("three/examples/jsm/shaders/BlendShader");var j=Object.freeze({HORIZONTAL:[1,0],VERTICAL:[0,1]}),A={uniforms:{tDiffuse:{value:null},radius:{value:1},resolution:{value:0},direction:{value:[0,0]}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    uniform sampler2D tDiffuse;\n    uniform float radius;\n    uniform float resolution;\n    uniform vec2 direction;\n    varying vec2 vUv;\n\n    void main() {\n      float blur = radius / resolution;\n      float h = direction.x;\n      float v = direction.y;\n\n      vec4 sum = vec4(0.0);\n\n      // optimized 33-tap filter that takes advantage of bilinear filtering (effectively 17 fetches)\n      sum += texture2D(tDiffuse, vec2(vUv.x - 15.0810810809 * blur * h, vUv.y - 15.0810810809 * blur * v)) * 1.13068382e-7;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 13.1351352551 * blur * h, vUv.y - 13.1351352551 * blur * v)) * 0.00000634313;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 11.1891891693 * blur * h, vUv.y - 11.1891891693 * blur * v)) * 0.00014981883;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 9.2432432422 * blur * h, vUv.y - 9.2432432422 * blur * v)) * 0.00181031093;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 7.29729729717 * blur * h, vUv.y - 7.29729729717 * blur * v)) * 0.01244177332;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 5.35135135135 * blur * h, vUv.y - 5.35135135135 * blur * v)) * 0.0518407222;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 3.40540540538 * blur * h, vUv.y - 3.40540540538 * blur * v)) * 0.13626704123;\n      sum += texture2D(tDiffuse, vec2(vUv.x - 1.45945945945 * blur * h, vUv.y - 1.45945945945 * blur * v)) * 0.23145357738;\n\n      sum += texture2D(tDiffuse, vUv) * 0.13206059971;\n\n      sum += texture2D(tDiffuse, vec2(vUv.x + 1.45945945945 * blur * h, vUv.y + 1.45945945945 * blur * v)) * 0.23145357738;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 3.40540540538 * blur * h, vUv.y + 3.40540540538 * blur * v)) * 0.13626704123;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 5.35135135135 * blur * h, vUv.y + 5.35135135135 * blur * v)) * 0.0518407222;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 7.29729729717 * blur * h, vUv.y + 7.29729729717 * blur * v)) * 0.01244177332;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 9.2432432422 * blur * h, vUv.y + 9.2432432422 * blur * v)) * 0.00181031093;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 11.1891891693 * blur * h, vUv.y + 11.1891891693 * blur * v)) * 0.00014981883;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 13.1351352551 * blur * h, vUv.y + 13.1351352551 * blur * v)) * 0.00000634313;\n      sum += texture2D(tDiffuse, vec2(vUv.x + 15.0810810809 * blur * h, vUv.y + 15.0810810809 * blur * v)) * 1.13068382e-7;\n\n      gl_FragColor = sum;\n    }\n  "};const I=require("three/examples/jsm/shaders/RGBShiftShader"),F=require("three/examples/jsm/shaders/VignetteShader");var V={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},size:{value:1}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    uniform sampler2D tDiffuse1;\n    uniform sampler2D tDiffuse2;\n    uniform float size;\n    varying vec2 vUv;\n\n    void main() {\n      vec2 uv = (vUv - vec2(0.5));\n      float mixRatio = smoothstep(0.0, 1.0, min(dot(uv, uv) * size, 1.0));\n      gl_FragColor = mix(texture2D(tDiffuse1, vUv), texture2D(tDiffuse2, vUv), mixRatio);\n    }\n\n  "},L={uniforms:{tDiffuse:{value:null},tDepth:{value:null},clipToWorldMatrix:{value:new a.Matrix4},prevWorldToClipMatrix:{value:new a.Matrix4},intensity:{value:1},samples:{value:32}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    const int MAX_SAMPLES = 128;\n\n    uniform sampler2D tDiffuse;\n    uniform sampler2D tDepth;\n    uniform mat4 clipToWorldMatrix;\n    uniform mat4 prevWorldToClipMatrix;\n    uniform float intensity;\n    uniform int samples;\n    varying vec2 vUv;\n\n    void main() {\n      float zOverW = texture2D(tDepth, vUv).x;\n      vec4 clipPosition = vec4(vUv.x, vUv.y, zOverW, 1.0);\n      vec4 worldPosition = clipToWorldMatrix * clipPosition;\n      worldPosition /= worldPosition.w;\n\n      vec4 prevClipPosition = prevWorldToClipMatrix * worldPosition;\n      prevClipPosition /= prevClipPosition.w;\n      vec2 velocity = ((clipPosition - prevClipPosition).xy + (clipPosition - prevClipPosition).zz) * intensity;\n\n      vec4 texel = texture2D(tDiffuse, vUv);\n      vec2 texelCoord = vUv;\n      for (int i = 1; i < MAX_SAMPLES; ++i) {\n        if (i >= samples) {\n          // hack to allow loop comparisons against uniforms\n          break;\n        }\n        // this offset calculation centers the blur which avoids unevenness favoring the direction of the velocity\n        vec2 offset = velocity * (float(i) / float(samples - 1) - 0.5);\n        texel += texture2D(tDiffuse, vUv + offset);\n      }\n\n      gl_FragColor = texel / max(1.0, float(samples));\n    }\n\n  "},W={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},resolution:{value:null},amount:{value:0},seed:{value:1}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    ".concat("\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : stegu\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//               https://github.com/stegu/webgl-noise\n// \n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v) {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                    -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n    + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n","\n\n    uniform sampler2D tDiffuse1;\n    uniform sampler2D tDiffuse2;\n    uniform float amount;\n    uniform float seed;\n    uniform vec2 resolution;\n    varying vec2 vUv;\n\n    vec2 tile(vec2 position, vec2 resolution, float size, float scale) {\n      vec2 tileSize = vec2(size / resolution.x * scale, size / resolution.y);\n      return tileSize * floor(position / tileSize);\n    }\n\n    float glitchNoise(vec2 position, vec2 resolution, float amount, float seed) {\n      // the amount affects the seeds used for noise and the multipliers for each type of glitch\n      float noise = 0.0;\n\n      // large rectangular glitch blocks\n      noise += max(snoise(tile(position, resolution, 488.0, 15.0) * (1.0 + amount * seed * 8.0)) * amount - 0.5, 0.0);\n\n      // medium square glitch blocks\n      noise += max(snoise(tile(position, resolution, 100.0, 1.0) * (4.0 + amount * seed * 2.0)) * amount - 0.3, 0.0);\n\n      // medium rectangular glitch blocks\n      noise += max(snoise(tile(position, resolution, 120.0, 8.0) * (4.0 + amount * seed * 4.0)) * amount - 0.2, 0.0);\n      noise += max(snoise(tile(position, resolution, 125.0, 8.0) * (4.0 + amount * seed * 4.0)) * amount - 0.2, 0.0);\n\n      // small rectangular glitch blocks\n      noise += max(snoise(tile(position, resolution, 29.0, 16.0) * (4.0 + amount * seed * 2.0)) * amount - 0.2, 0.0);\n\n      // small square glitch blocks\n      noise += max(snoise(tile(position, resolution, 29.0, 1.0) * (8.0 + amount * seed * 2.0)) * amount - 0.7, 0.0);\n\n      if (noise >= 0.6) {\n        // thin glitch lines - fill existing glitch blocks\n        noise += max(snoise(tile(position, resolution, 1.1, 1000.0) * 1000.0) * amount, 0.0);\n      } else if (noise <= 0.0) {\n        // thin glitch lines - fill remaining empty space\n        float lineNoise = max(snoise(tile(position, resolution, 1.1, 500.0) * (500.0 + amount * seed * 100.0)) * amount, 0.0);\n        lineNoise += min(snoise(tile(position, resolution, 100.0, 3.0) * (4.0 + amount * seed * 2.0)) * amount, 0.0);\n        noise += max(lineNoise, 0.0);\n      }\n\n      // coerce to max glitch amount\n      float glitchCoerceThreshold = 0.9;\n      if (amount >= glitchCoerceThreshold) {\n        float percent = (amount - glitchCoerceThreshold) / (1.0 - glitchCoerceThreshold);\n        return noise + (1.0 * percent);\n      }\n\n      return noise;\n    }\n\n    vec4 rgbShift(sampler2D tex, vec2 position, vec3 offset) {\n      vec4 r = texture2D(tex, position + vec2(offset.r, 0.0));\n      vec4 g = texture2D(tex, position + vec2(offset.g, 0.0));\n      vec4 b = texture2D(tex, position + vec2(offset.b, 0.0));\n      return vec4(r.r, g.g, b.b, 1.0);\n    }\n\n    void main() {\n      float glitch = glitchNoise(vUv, resolution, amount, seed);\n\n      vec3 rgbShiftOffset = vec3(0.01, 0.0, -0.01);\n      vec4 texel1 = texture2D(tDiffuse1, vUv);\n      vec4 shiftedTexel1 = rgbShift(tDiffuse1, vUv, rgbShiftOffset);\n      vec4 texel2 = texture2D(tDiffuse2, vUv);\n      vec4 shiftedTexel2 = rgbShift(tDiffuse2, vUv, rgbShiftOffset);\n\n      vec4 color = texel1;\n      if (glitch >= 0.95) {\n        // no glitching\n        color = texel2;\n      } else if (glitch >= 0.7) {\n        // color-shifted new texture\n        color = shiftedTexel2;\n      } else if (glitch >= 0.6) {\n        // color-shifted original texture\n        color = shiftedTexel1;\n      } else if (glitch >= 0.5) {\n        // magenta glitch blocks\n        color = texel1 * vec4(1.2, 0.0, 1.2, 0.5);\n      } else if (glitch >= 0.4) {\n        // cyan glitch blocks\n        color = texel1 * vec4(0.0, 1.2, 1.2, 0.5);\n      } else if (glitch >= 0.38) {\n        // bright color-shifted new texture\n        color = shiftedTexel2 * 1.5;\n      } else if (glitch >= 0.2) {\n        // color-shifted original texture\n        color = shiftedTexel1;\n      }\n\n      gl_FragColor = color;\n    }\n\n  ")};function G(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in e){if(void 0===t.uniforms[n])throw new Error('Uniform "'.concat(n,'" does not exist on shader "').concat(t.name,'"'));t.uniforms[n].value=e[n]}}var N,q={getUniforms:function(t){var e={};for(var n in t.uniforms)e[n]=t.uniforms[n].value;return e},updateUniforms:G,clearUniforms:function(t){t.uniforms=a.UniformsUtils.clone(t.uniforms)},createShaderMaterial:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new a.ShaderMaterial({uniforms:a.UniformsUtils.clone(t.uniforms),vertexShader:t.vertexShader,fragmentShader:t.fragmentShader});return G(n,e),n}},X=["opacity"],Y=["size"];function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=O(t);if(e){var o=O(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return E(this,n)}}function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}!function(t){t.Blur="Blur",t.Bloom="Bloom",t.RgbShift="RgbShift",t.Vignette="Vignette",t.VignetteBlur="VignetteBlur",t.MotionBlur="MotionBlur",t.Glitch="Glitch"}(N||(N={}));var $=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t),s(this,"_quad",new z.FullScreenQuad),this._quad.material=q.createShaderMaterial(e,n)}return r(t,[{key:"getUniforms",value:function(){return q.getUniforms(this._quad.material)}},{key:"updateUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q.updateUniforms(this._quad.material,t)}},{key:"clearUniforms",value:function(){q.clearUniforms(this._quad.material)}},{key:"render",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.setRenderTarget(e),this.updateUniforms(Q(Q({},i),{},{tDiffuse:n.texture})),this._quad.render(t)}},{key:"dispose",value:function(){this._quad.material.dispose()}}]),t}(),J=function(t){T(n,t);var e=Z(n);function n(){return i(this,n),e.apply(this,arguments)}return r(n,[{key:"render",value:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t.setRenderTarget(e),this.updateUniforms(Q(Q({},o),{},{tDiffuse1:n.texture,tDiffuse2:i.texture})),this._quad.render(t)}}]),n}($),K=function(t){T(n,t);var e=Z(n);function n(t,o){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,n),s(k(r=e.call(this,L,a)),"camera",void 0),s(k(r),"depthTexture",void 0),r.camera=t,r.depthTexture=o,r}return r(n,[{key:"render",value:function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getUniforms(),s=r.clipToWorldMatrix,a=r.prevWorldToClipMatrix;P(O(n.prototype),"render",this).call(this,t,e,i,Q(Q({},o),{},{tDepth:this.depthTexture,clipToWorldMatrix:s.copy(this.camera.projectionMatrixInverse).multiply(this.camera.matrixWorld)})),a.copy(this.camera.matrixWorldInverse).multiply(this.camera.projectionMatrix)}}]),n}($),tt=function(t){T(n,t);var e=Z(n);function n(t,o){var r,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,n),s(k(r=e.call(this,A,u)),"_width",void 0),s(k(r),"_height",void 0),s(k(r),"_buffer",void 0),s(k(r),"passes",1),r._width=t,r._height=o,r._buffer=new a.WebGLRenderTarget(t,o),r}return r(n,[{key:"setSize",value:function(t,e){this._width=t,this._height=e,this._buffer.setSize(t,e)}},{key:"render",value:function(t,e,i){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=0;r<this.passes;++r)P(O(n.prototype),"render",this).call(this,t,this._buffer,0===r?i:e,Q(Q({},o),{},{direction:j.HORIZONTAL,resolution:this._width})),P(O(n.prototype),"render",this).call(this,t,e,this._buffer,Q(Q({},o),{},{direction:j.VERTICAL,resolution:this._height}))}},{key:"dispose",value:function(){this._buffer.dispose(),P(O(n.prototype),"dispose",this).call(this)}}]),n}($),et=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,t),s(this,"_blurEffect",void 0),s(this,"_blendEffect",void 0),s(this,"_blendBuffer",void 0),this._blurEffect=new tt(e,n),this._blendEffect=new J(C.BlendShader,{mixRatio:.5}),this._blendBuffer=new a.WebGLRenderTarget(e,n),this.updateUniforms(o)}return r(t,[{key:"passes",get:function(){return this._blurEffect.passes},set:function(t){this._blurEffect.passes=t}},{key:"setSize",value:function(t,e){this._blurEffect.setSize(t,e),this._blendBuffer.setSize(t,e)}},{key:"getUniforms",value:function(){var t=this._blendEffect.getUniforms().opacity;return Q(Q({},this._blurEffect.getUniforms()),{},{opacity:t})}},{key:"updateUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._blendEffect.getUniforms(),i=t.opacity,o=void 0===i?e.opacity:i,r=n(t,X);this._blurEffect.updateUniforms(r),this._blendEffect.updateUniforms({opacity:o})}},{key:"clearUniforms",value:function(){this._blurEffect.clearUniforms(),this._blendEffect.clearUniforms(),this._blendEffect.updateUniforms({mixRatio:.5})}},{key:"render",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._blurEffect.render(t,this._blendBuffer,n,i),this._blendEffect.render(t,e,n,this._blendBuffer)}},{key:"dispose",value:function(){this._blendEffect.dispose(),this._blendBuffer.dispose()}}]),t}(),nt=function(t){T(n,t);var e=Z(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,n),e.call(this,I.RGBShiftShader,t)}return n}($),it=function(t){T(n,t);var e=Z(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,n),e.call(this,F.VignetteShader,t)}return n}($),ot=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,t),s(this,"_blurEffect",void 0),s(this,"_blendEffect",void 0),s(this,"_blendBuffer",void 0),this._blurEffect=new tt(e,n),this._blendEffect=new J(V),this._blendBuffer=new a.WebGLRenderTarget(e,n),this.updateUniforms(o)}return r(t,[{key:"passes",get:function(){return this._blurEffect.passes},set:function(t){this._blurEffect.passes=t}},{key:"setSize",value:function(t,e){this._blurEffect.setSize(t,e),this._blendBuffer.setSize(t,e)}},{key:"getUniforms",value:function(){var t=this._blendEffect.getUniforms().size;return Q(Q({},this._blurEffect.getUniforms()),{},{size:t})}},{key:"updateUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._blendEffect.getUniforms(),i=t.size,o=void 0===i?e.size:i,r=n(t,Y);this._blurEffect.updateUniforms(r),this._blendEffect.updateUniforms({size:o})}},{key:"clearUniforms",value:function(){this._blurEffect.clearUniforms(),this._blendEffect.clearUniforms()}},{key:"render",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._blurEffect.render(t,this._blendBuffer,n,i),this._blendEffect.render(t,e,n,this._blendBuffer)}},{key:"dispose",value:function(){this._blurEffect.dispose(),this._blendEffect.dispose(),this._blendBuffer.dispose()}}]),t}(),rt=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,t),s(this,"_resolution",void 0),s(this,"_glitchEffect",void 0),s(this,"_blurEffect",void 0),s(this,"_blurBuffer",void 0),this._resolution=new a.Vector2(e,n),this._glitchEffect=new J(W),this._blurEffect=new tt(e,n,{radius:3}),this._blurEffect.passes=2,this._blurBuffer=new a.WebGLRenderTarget(e,n),this.updateUniforms(o)}return r(t,[{key:"setSize",value:function(t,e){this._resolution.set(t,e),this._blurEffect.setSize(t,e),this._blurBuffer.setSize(t,e)}},{key:"getUniforms",value:function(){return this._glitchEffect.getUniforms()}},{key:"updateUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._glitchEffect.updateUniforms(t)}},{key:"clearUniforms",value:function(){this._glitchEffect.clearUniforms()}},{key:"render",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._blurEffect.render(t,this._blurBuffer,n),this._glitchEffect.render(t,e,n,this._blurBuffer,Q(Q({},i),{},{resolution:this._resolution}))}},{key:"dispose",value:function(){this._glitchEffect.dispose(),this._blurEffect.dispose(),this._blurBuffer.dispose()}}]),t}();var st=function(t){T(u,t);var e,n,o=(e=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=O(e);if(n){var o=O(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return E(this,t)});function u(t,e){var n;return i(this,u),s(k(n=o.call(this)),"_width",void 0),s(k(n),"_height",void 0),s(k(n),"_readBuffer",void 0),s(k(n),"_writeBuffer",void 0),s(k(n),"_copyShader",new $(R.CopyShader)),s(k(n),"_effects",{}),n._width=t,n._height=e,n._readBuffer=new a.WebGLRenderTarget(t,e),n._writeBuffer=new a.WebGLRenderTarget(t,e),n.enabled=!1,n}return r(u,[{key:"setSize",value:function(t,e){this._width=t,this._height=e,this._readBuffer.setSize(t,e),this._writeBuffer.setSize(t,e);for(var n=0,i=Object.values(this._effects);n<i.length;n++){var o=i[n];o.setSize&&o.setSize(t,e)}}},{key:"getConfigs",value:function(){for(var t={},e=0,n=Object.entries(this._effects);e<n.length;e++){var i=(w=n[e],S=2,function(t){if(Array.isArray(t))return t}(w)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(w,S)||function(t,e){if(t){if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}}(w,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],r=i[1];switch(o){case N.Blur:var s=r.getUniforms().radius;t[o]={radius:s,passes:r.passes};break;case N.Bloom:var a=r.getUniforms(),u=a.opacity,f=a.radius;t[o]={opacity:u,radius:f,passes:r.passes};break;case N.RgbShift:var c=r.getUniforms(),l=c.amount,h=c.angle;t[o]={amount:l,angle:h};break;case N.Vignette:var d=r.getUniforms(),v=d.offset,p=d.darkness;t[o]={offset:v,darkness:p};break;case N.VignetteBlur:var m=r.getUniforms(),_=m.size,g=m.radius;t[o]={size:_,radius:g,passes:r.passes};break;case N.Glitch:var y=r.getUniforms(),b=y.amount,x=y.seed;t[o]={amount:b,seed:x}}}var w,S;return t}},{key:"hasEffect",value:function(t){return this._effects.hasOwnProperty(t)}},{key:"hasEffects",value:function(){return 0!==Object.getOwnPropertyNames(this._effects).length}},{key:"_getEffect",value:function(t){if(!(t in this._effects))switch(t){case N.Blur:this._effects[t]=new tt(this._width,this._height);break;case N.Bloom:this._effects[t]=new et(this._width,this._height);break;case N.RgbShift:this._effects[t]=new nt;break;case N.Vignette:this._effects[t]=new it;break;case N.VignetteBlur:this._effects[t]=new ot(this._width,this._height);break;case N.Glitch:this._effects[t]=new rt(this._width,this._height)}return this._effects[t]}},{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._getEffect(t);switch(this.enabled=!0,t){case N.Blur:var i=e,o=i.radius,r=void 0===o?1:o,s=i.passes,u=void 0===s?n.passes:s;n.passes=u,n.updateUniforms({radius:r});break;case N.Bloom:var f=e,c=f.opacity,l=void 0===c?1:c,h=f.radius,d=void 0===h?1:h,v=f.passes,p=void 0===v?n.passes:v;n.passes=p,n.updateUniforms({opacity:l,radius:d});break;case N.RgbShift:var m=e,_=m.amount,g=void 0===_?.005:_,y=m.angle,b=void 0===y?0:y;n.updateUniforms({amount:g,angle:a.MathUtils.degToRad(b)});break;case N.Vignette:var x=e,w=x.offset,S=void 0===w?1:w,U=x.darkness,k=void 0===U?1:U;n.updateUniforms({offset:S,darkness:k});break;case N.VignetteBlur:var O=e,P=O.size,D=void 0===P?1:P,T=O.radius,M=void 0===T?1:T,E=O.passes,B=void 0===E?n.passes:E;n.passes=B,n.updateUniforms({radius:M,size:D});break;case N.Glitch:var z=e,R=z.amount,C=void 0===R?1:R,j=z.seed,A=void 0===j?Math.random():j;n.updateUniforms({amount:C,seed:A})}}},{key:"remove",value:function(t){return t in this._effects&&(this._effects[t].dispose(),delete this._effects[t],this.enabled=this.hasEffects(),!0)}},{key:"removeAll",value:function(){for(var t in this._effects)this._effects[t].dispose(),delete this._effects[t];this.enabled=!1}},{key:"_swapBuffers",value:function(){var t=this._readBuffer;this._readBuffer=this._writeBuffer,this._writeBuffer=t}},{key:"render",value:function(t,e,n){this._copyShader.render(t,this._readBuffer,n);for(var i=0,o=Object.values(this._effects);i<o.length;i++)o[i].render(t,this._writeBuffer,this._readBuffer),this._swapBuffers();this._copyShader.render(t,this.renderToScreen?null:e,this._readBuffer)}},{key:"dispose",value:function(){this._copyShader.dispose(),this._readBuffer.dispose(),this._readBuffer.texture.dispose(),this._writeBuffer.dispose(),this._writeBuffer.texture.dispose(),Object.values(this._effects).forEach((function(t){return t.dispose()}))}}]),u}(z.Pass);var at=function(t){T(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=O(e);if(n){var o=O(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return E(this,t)});function a(t,e,n,r){var u;return i(this,a),s(k(u=o.call(this,t,e)),"_camera",void 0),s(k(u),"_depthTexture",void 0),u._camera=n,u._depthTexture=r,u}return r(a,[{key:"getConfigs",value:function(){var t=P(O(a.prototype),"getConfigs",this).call(this),e=this._effects[N.MotionBlur];if(e){var n=e.getUniforms(),i=n.intensity,o=n.samples;t[N.MotionBlur]={intensity:i,samples:o}}return t}},{key:"_getEffect",value:function(t){return t!==N.MotionBlur||t in this._effects?P(O(a.prototype),"_getEffect",this).call(this,t):(this._effects[N.MotionBlur]=new K(this._camera,this._depthTexture),this._effects[N.MotionBlur])}},{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t===N.MotionBlur){this.enabled=!0;var n=this._getEffect(N.MotionBlur),i=e,o=i.intensity,r=void 0===o?1:o,s=i.samples,u=void 0===s?32:s;n.updateUniforms({intensity:r,samples:u})}else P(O(a.prototype),"set",this).call(this,t,e)}}]),a}(st),ut={uniforms:{},vertexShader:"\n\n    attribute float size;\n\n    // a value from 0 to 1 indicating the size of the blend gradient\n    attribute float gradient;\n    varying float v_gradient;\n\n    // a value from 0 to 1 indicating the opacity of the particle\n    attribute float opacity;\n    varying float v_opacity;\n\n    // the color of the particle\n    attribute vec3 color;\n    varying vec3 v_color;\n\n    void main() {\n      v_gradient = gradient;\n      v_opacity = opacity;\n      v_color = color;\n      \n      gl_PointSize = size;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    varying float v_diameter;\n    varying float v_gradient;\n    varying float v_opacity;\n    varying vec3 v_color;\n\n    void main() {\n      float radius = 0.5;\n      float distanceFromCenter = distance(gl_PointCoord, vec2(0.5, 0.5));\n      if (distanceFromCenter > radius) {\n        discard;\n      }\n      gl_FragColor = vec4(v_color, min((radius - distanceFromCenter) / smoothstep(0.0, 1.0, v_gradient * radius), 1.0) * v_opacity);\n    }\n\n  "};function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var ct=function(){function t(e,n,o){i(this,t),s(this,"_width",void 0),s(this,"_height",void 0),s(this,"_maxDepth",void 0),s(this,"_groups",{}),s(this,"_particles",void 0),s(this,"_positions",[]),this._width=e,this._height=n,this._maxDepth=o;var r=new a.BufferGeometry;r.setAttribute("position",new a.Float32BufferAttribute(0,3)),r.setAttribute("size",new a.Float32BufferAttribute(0,1)),r.setAttribute("gradient",new a.Float32BufferAttribute(0,1)),r.setAttribute("opacity",new a.Float32BufferAttribute(0,1)),r.setAttribute("color",new a.Float32BufferAttribute(0,3)),this._particles=new a.Points(r,q.createShaderMaterial(ut))}return r(t,[{key:"getConfigs",value:function(){for(var t={},e=0,n=Object.values(this._groups);e<n.length;e++){var i=n[e],o=i.name,r=i.amount,s=i.minSize,a=i.maxSize,u=i.minGradient,f=i.maxGradient,c=i.minOpacity,l=i.maxOpacity,h=i.color;t[o]={name:o,amount:r,minSize:s,maxSize:a,minGradient:u,maxGradient:f,minOpacity:c,maxOpacity:l,color:h}}return t}},{key:"isMoving",value:function(t){var e,n;return null!==(e=null===(n=this._groups[t])||void 0===n?void 0:n.positionTransition.isPlaying())&&void 0!==e&&e}},{key:"isSwaying",value:function(t){var e,n;return null!==(e=null===(n=this._groups[t])||void 0===n?void 0:n.swayTransition.isPlaying())&&void 0!==e&&e}},{key:"generate",value:function(t){this.removeAll();var e,n=0,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ft(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ft(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw r}}}}(t=Array.isArray(t)?t:[t]);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,r=o.name,s=o.amount,u=void 0===s?0:s,f=o.minSize,c=void 0===f?0:f,l=o.maxSize,h=void 0===l?0:l,d=o.minGradient,v=void 0===d?0:d,p=o.maxGradient,m=void 0===p?1:p,g=o.minOpacity,y=void 0===g?0:g,b=o.maxOpacity,x=void 0===b?1:b,w=o.color,S=void 0===w?16777215:w,U=o.smoothing,k=void 0===U?.5:U,O=0;O<u;++O){var P=-this._width/2+Math.random()*this._width,D=-this._height/2+Math.random()*this._height,T=this._maxDepth/4*Math.random();this._positions.push(P,D,T)}this._groups[r]={name:r,index:n,amount:u,minSize:c,maxSize:h,minGradient:v,maxGradient:m,minOpacity:y,maxOpacity:x,color:S,smoothing:k,swayOffset:new a.Vector2(0,0),positionTransition:new _({offsetX:0,offsetY:0}),swayTransition:new _({offsetX:0,offsetY:0})},n+=u}}catch(t){i.e(t)}finally{i.f()}var M=new a.BufferGeometry;M.setAttribute("position",new a.Float32BufferAttribute(3*n,3)),M.setAttribute("color",new a.Float32BufferAttribute(3*n,3)),M.setAttribute("size",new a.Float32BufferAttribute(n,1)),M.setAttribute("gradient",new a.Float32BufferAttribute(n,1)),M.setAttribute("opacity",new a.Float32BufferAttribute(n,1));var E=q.createShaderMaterial(ut);E.transparent=!0,this._particles.geometry=M,this._particles.material=E}},{key:"removeAll",value:function(){for(var t in this._groups)this._groups[t].positionTransition.stop(),this._groups[t].swayTransition.stop();this._positions=[],this._groups={},this._particles.geometry.dispose(),this._particles.material.dispose()}},{key:"_getNewPosition",value:function(t,e){var n=e.x,i=e.y;n%=this._width,i%=this._height;var o=t.x+n,r=t.y+i,s=this._width/2,u=this._height/2;return Math.abs(t.x+n)>s&&(o=n>0?-s+(t.x+n-s)%this._width:s-(Math.abs(t.x+n)-s)%this._width),Math.abs(t.y+i)>u&&(r=i>0?-u+(t.y+i-u)%this._height:u-(Math.abs(t.y+i)-u)%this._height),new a.Vector2(o,r)}},{key:"_updatePositions",value:function(t,e,n,i){for(var o=t;o<t+e;++o){var r=this._getNewPosition(new a.Vector2(n[3*o],n[3*o+1]),i),s=r.x,u=r.y;this._positions[3*o]=s,this._positions[3*o+1]=u}}},{key:"move",value:function(t,e,n){var i=this,o=this._groups[t],r=o.index,s=o.amount;if("boolean"!=typeof e){o.positionTransition.stop();var u=n.loop,f=void 0!==u&&u,c=n.duration,h=void 0===c?0:c,d=n.easing,v=void 0===d?l.Linear.None:d,p=n.onStart,m=void 0===p?function(){return{}}:p,g=n.onUpdate,y=void 0===g?function(){return{}}:g,b=n.onComplete,x=void 0===b?function(){return{}}:b,w=n.onStop,S=void 0===w?function(){return{}}:w,U=e.distance,k=e.angle,O=U*Math.cos(a.MathUtils.degToRad(k)),P=U*Math.sin(a.MathUtils.degToRad(k));if(h>0){var D=this._positions.slice();o.positionTransition=new _({offsetX:0,offsetY:0}).to({offsetX:O,offsetY:P},1e3*h).easing(v).onStart(m).onUpdate((function(t){var e=t.offsetX,n=t.offsetY;i._updatePositions(r,s,D,new a.Vector2(e,n)),y()})).onComplete((function(){f&&i.move(t,e,n),x()})).onStop(S).start()}else this._updatePositions(r,s,this._positions,new a.Vector2(O,P))}else e||o.positionTransition.stop()}},{key:"sway",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this._groups[t],r=o.swayOffset;if("boolean"!=typeof e){o.swayTransition.stop();var s=i.loop,a=void 0!==s&&s,u=i.duration,f=void 0===u?0:u,c=i.easing,h=void 0===c?l.Linear.None:c,d=i.onStart,v=void 0===d?function(){return{}}:d,p=i.onUpdate,m=void 0===p?function(){return{}}:p,g=i.onComplete,y=void 0===g?function(){return{}}:g,b=i.onStop,x=void 0===b?function(){return{}}:b,w=e.x,S=e.y;o.swayTransition=new _({offsetX:r.x,offsetY:r.y}).to({offsetX:-w+Math.random()*w,offsetY:-S+Math.random()*S},1e3*f).easing(h).onStart(v).onUpdate((function(t){var e=t.offsetX,n=t.offsetY;r.set(e,n),m()})).onComplete((function(){a&&n.sway(t,e,i),y()})).onStop(x).start()}else e||o.swayTransition.stop()}},{key:"_generateNewRandomAveragedValue",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;i=Math.min(i,.95);var o=(n-e)/2,r=Math.max(Math.min(t+(-o+Math.random()*o*2),n),e),s=t*i+r*(1-i);return Math.max(Math.min(s,n),e)}},{key:"update",value:function(){for(var t=this._particles.geometry.attributes,e=t.position,n=t.size,i=t.gradient,o=t.opacity,r=t.color,s=0,u=Object.values(this._groups);s<u.length;s++)for(var f=u[s],c=f.index,l=f.amount,h=f.minSize,d=f.maxSize,v=f.minGradient,p=f.maxGradient,m=f.minOpacity,_=f.maxOpacity,g=f.color,y=f.smoothing,b=f.swayOffset,x=c;x<c+l;++x){var w=this._getNewPosition(new a.Vector2(this._positions[3*x],this._positions[3*x+1]),b),S=new a.Color(g);e.setXYZ(x,w.x,w.y,this._positions[3*x+2]),r.setXYZ(x,S.r,S.g,S.b),n.setX(x,this._generateNewRandomAveragedValue(n.getX(x),h,d,y)),i.setX(x,this._generateNewRandomAveragedValue(i.getX(x),v,p,y)),o.setX(x,this._generateNewRandomAveragedValue(o.getX(x),m,_,y))}t.position.needsUpdate=!0,t.size.needsUpdate=!0,t.gradient.needsUpdate=!0,t.opacity.needsUpdate=!0,t.color.needsUpdate=!0}},{key:"object",get:function(){return this._particles}},{key:"dispose",value:function(){this._particles.geometry.dispose(),this._particles.material.dispose()}}]),t}(),lt=function(){function t(e,n,o){i(this,t),s(this,"_buffer",void 0),s(this,"_plane",void 0),s(this,"_scene",void 0),s(this,"camera",void 0),s(this,"particles",void 0),s(this,"effects",void 0),this._buffer=new a.WebGLRenderTarget(n,o),this._buffer.depthTexture=new a.DepthTexture(n,o);var r=1/(e&&void 0!==e.image?e.image.width/e.image.height:1);this._plane=new a.Mesh(new a.PlaneGeometry(1,r),new a.MeshBasicMaterial({map:e})),this.camera=new U(this._plane,n,o),this.particles=new ct(1.1,1.1*r,S(this._plane,this.camera.camera,0)),this.effects=new at(n,o,this.camera.camera,this._buffer.depthTexture),this._scene=new a.Scene,this._scene.add(this.particles.object),this._scene.add(this._plane)}return r(t,[{key:"texture",get:function(){return this._plane.material.map}},{key:"setSize",value:function(t,e){this.camera.setSize(t,e),this._buffer.setSize(t,e),this._buffer.depthTexture.image.width=t,this._buffer.depthTexture.image.height=e}},{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.camera.update(),this.particles.update(),t.setRenderTarget(this._buffer),t.render(this._scene,this.camera.camera),this.effects.hasEffects()?this.effects.render(t,e,this._buffer):(t.setRenderTarget(e),t.render(this._scene,this.camera.camera))}},{key:"dispose",value:function(){this._buffer.dispose(),this._buffer.texture.dispose(),this._buffer.depthTexture.dispose(),this._plane.geometry.dispose(),this._plane.material.dispose(),this.camera.dispose(),this.effects.dispose(),this.particles.dispose()}}]),t}();var ht,dt=function(t){T(a,t);var e,n,o=(e=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=O(e);if(n){var o=O(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return E(this,t)});function a(t){var e;return i(this,a),s(k(e=o.call(this)),"_background",void 0),e._background=t,e}return r(a,[{key:"setBackground",value:function(t){this._background=t}},{key:"background",get:function(){return this._background}},{key:"setSize",value:function(t,e){this._background.setSize(t,e)}},{key:"render",value:function(t,e){this._background.render(t,this.renderToScreen?null:e)}},{key:"dispose",value:function(){this._background.dispose()}}]),a}(z.Pass);!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom"}(ht||(ht={}));var vt,pt={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},amount:{value:0},gradient:{value:0},direction:{value:ht.Right},angle:{value:0},aspect:{value:1}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    uniform sampler2D tDiffuse1;\n    uniform sampler2D tDiffuse2;\n    uniform float amount;\n    uniform float gradient;\n    uniform int direction;\n    uniform float angle;\n    uniform float aspect;\n    varying vec2 vUv;\n\n    void main() {\n      vec4 texel1 = texture2D(tDiffuse1, vUv);\n      vec4 texel2 = texture2D(tDiffuse2, vUv);\n\n      float position;\n      if (direction == 0) {\n        // WipeDirection.LEFT\n        position = 1.0 - vUv.x;\n      } else if (direction == 1) {\n        // WipeDirection.RIGHT\n        position = vUv.x;\n      } else if (direction == 2) {\n        // WipeDirection.TOP\n        position = vUv.y;\n      } else if (direction == 3) {\n        // WipeDirection.BOTTOM\n        position = 1.0 - vUv.y;\n      }\n\n      float rotationOffset;\n      float rotatedPosition;\n      if (direction < 2) {\n        // rotation for horizontal wipes\n        float slope = 1.0 / tan(angle);\n        rotationOffset = (1.0 / slope) / aspect;\n        rotatedPosition = (vUv.y / slope) / aspect;\n      } else {\n        // rotation for vertical wipes\n        float slope = tan(angle);\n        rotationOffset = slope / aspect;\n        rotatedPosition = (vUv.x * slope) / aspect;\n      }\n\n      // a tween that starts from one side of the texture and ends at the other side.\n      // this tween accounts for offsets due to the size of the blend gradient and angle of the wipe effect.\n      float wipeOffset = (-max(0.0, rotationOffset) - gradient) + ((1.0 + abs(rotationOffset) + gradient) * amount) + rotatedPosition;\n      if (position <= wipeOffset) {\n        gl_FragColor = texel2;\n      } else if (position <= wipeOffset + gradient) {\n        gl_FragColor = mix(texel2, texel1, (position - wipeOffset) / gradient);\n      } else {\n        gl_FragColor = texel1;\n      }\n    }\n\n  "};!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom"}(vt||(vt={}));var mt,_t={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},slides:{value:1},amount:{value:0},prevAmount:{value:0},intensity:{value:1},direction:{value:vt.Right},samples:{value:32}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    const int MAX_SAMPLES = 128;\n\n    uniform sampler2D tDiffuse1;\n    uniform sampler2D tDiffuse2;\n    uniform int slides;\n    uniform float amount;\n    uniform float prevAmount;\n    uniform float intensity;\n    uniform int direction;\n    uniform int samples;\n    varying vec2 vUv;\n\n    float getComponentForDirection(int direction, vec2 uv) {\n      return direction < 2 ? uv.x : uv.y;\n    }\n\n    vec2 getVectorForDirection(int direction, vec2 uv, float position) {\n      return direction < 2 ? vec2(position, uv.y) : vec2(uv.x, position);\n    }\n\n    float getOffsetPosition(int direction, float uv, float offset) {\n      return direction == 1 || direction == 3\n        ? mod(uv + offset, 1.0)\n        : mod(uv + (1.0 - offset), 1.0);\n    }\n\n    void main() {\n      vec4 texel;\n      float offset = amount * float(slides);\n      float position = getComponentForDirection(direction, vUv);\n\n      bool isFirstSlide = direction == 1 || direction == 3\n        ? position + offset <= 1.0\n        : position - offset >= 0.0;\n\n      if (isFirstSlide) {\n        texel = texture2D(tDiffuse1, getVectorForDirection(direction, vUv, getOffsetPosition(direction, position, offset)));\n      } else {\n        texel = texture2D(tDiffuse2, getVectorForDirection(direction, vUv, getOffsetPosition(direction, position, offset)));\n      }\n\n      float velocity = (amount - prevAmount) * intensity;\n      for (int i = 1; i < MAX_SAMPLES; ++i) {\n        if (i >= samples) {\n          // hack to allow loop comparisons against uniforms\n          break;\n        }\n        float blurOffset = velocity * (float(i) / float(samples - 1) - 0.5);\n        bool isFirstSlide = direction == 1 || direction == 3\n          ? position + offset + blurOffset <= 1.0\n          : position - offset - blurOffset >= 0.0;\n        if (isFirstSlide) {\n          texel += texture2D(tDiffuse1, getVectorForDirection(direction, vUv, getOffsetPosition(direction, position, offset + blurOffset)));\n        } else {\n          texel += texture2D(tDiffuse2, getVectorForDirection(direction, vUv, getOffsetPosition(direction, position, offset + blurOffset)));\n        }\n      }\n\n      gl_FragColor = texel / max(1.0, float(samples));\n    }\n\n  "},gt={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},amount:{value:0},prevAmount:{value:0},intensity:{value:1},samples:{value:32}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    const int MAX_SAMPLES = 128;\n\n    uniform sampler2D tDiffuse1;\n    uniform sampler2D tDiffuse2;\n    uniform float amount;\n    uniform float prevAmount;\n    uniform float intensity;\n    uniform int samples;\n    varying vec2 vUv;\n\n\n    void main() {\n      vec4 texel = mix(texture2D(tDiffuse1, vUv), texture2D(tDiffuse2, vUv), amount);\n      float velocity = (amount - prevAmount) * intensity;\n      for (int i = 1; i < MAX_SAMPLES; ++i) {\n        if (i >= samples) {\n          // hack to allow loop comparisons against uniforms\n          break;\n        }\n        float offset = velocity * (float(i) / float(samples - 1) - 0.5);\n        texel += mix(texture2D(tDiffuse1, vec2(vUv.x + offset, vUv.y)), texture2D(tDiffuse2, vec2(vUv.x + offset, vUv.y)), amount);\n      }\n\n      gl_FragColor = texel / max(1.0, float(samples));\n    }\n\n  "},yt=["easing","duration","delay","onInit","onStart","onUpdate","onComplete","onStop"];function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}!function(t){t.None="None",t.Blend="Blend",t.Blur="Blur",t.Wipe="Wipe",t.Slide="Slide",t.Glitch="Glitch"}(mt||(mt={}));var wt=function(t){T(f,t);var e,o,u=(e=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=O(e);if(o){var i=O(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return E(this,t)});function f(t,e,n){var o;return i(this,f),s(k(o=u.call(this)),"_width",void 0),s(k(o),"_height",void 0),s(k(o),"_prevBackground",void 0),s(k(o),"_buffer",void 0),s(k(o),"_transition",new _({amount:0})),s(k(o),"_transitionEffect",new J(C.BlendShader,{mixRatio:1})),o._width=e,o._height=n,o._prevBackground=null!=t?t:new lt(null,e,n),o._buffer=new a.WebGLRenderTarget(e,n),o.enabled=!1,o}return r(f,[{key:"setSize",value:function(t,e){this._width=t,this._height=e,this._prevBackground.setSize(t,e),this._buffer.setSize(t,e)}},{key:"isTransitioning",value:function(){return this._transition.isPlaying()}},{key:"transition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this._getTweenConfig(t,e,n),o=i.from,r=i.to,s=i.duration,a=i.delay,u=i.easing,f=i.onInit,c=i.onStart,l=i.onUpdate,h=i.onComplete,d=i.onStop;this._transition.stop(),f(),this._transition=new _(o).to(r,s).easing(u).onStart(c).onUpdate(l).onComplete(h).onStop(d).delay(a).start()}},{key:"_setTransitionEffect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._transitionEffect.dispose(),this._transitionEffect=new J(t,e)}},{key:"_getTweenConfig",value:function(t,e){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(){i.enabled=!0},s=function(){i.enabled=!1,i._prevBackground.dispose(),i._prevBackground=t},u=o.easing,f=void 0===u?l.Linear.None:u,c=o.duration,h=void 0===c?0:c,d=o.delay,v=void 0===d?0:d,p=o.onInit,m=void 0===p?function(){return{}}:p,_=o.onStart,g=void 0===_?function(){return{}}:_,y=o.onUpdate,b=void 0===y?function(){return{}}:y,x=o.onComplete,w=void 0===x?function(){return{}}:x,S=o.onStop,U=void 0===S?function(){return{}}:S,k=n(o,yt),O={from:{amount:0},to:{amount:1},easing:f,duration:1e3*h,delay:1e3*v,onInit:function(){return m(i._prevBackground,t)},onStart:function(){g(i._prevBackground,t),r()},onUpdate:function(){return b(i._prevBackground,t)},onComplete:function(){w(i._prevBackground,t),s()},onStop:function(){U(i._prevBackground,t),s()}};switch(e){case mt.None:var P=O.onStart;return xt(xt({},O),{},{onStart:function(){i._setTransitionEffect(C.BlendShader,{mixRatio:1}),P()}});case mt.Blend:var D=O.onStart,T=O.onUpdate;return xt(xt({},O),{},{onStart:function(){i._setTransitionEffect(C.BlendShader),D()},onUpdate:function(t){var e=t.amount;i._transitionEffect.updateUniforms({mixRatio:e}),T()}});case mt.Wipe:var M=O.onStart,E=O.onUpdate,B=k,z=B.gradient,R=void 0===z?0:z,j=B.angle,A=void 0===j?0:j,I=B.direction,F=void 0===I?ht.Right:I;return xt(xt({},O),{},{onStart:function(){i._setTransitionEffect(pt,{gradient:R,angle:a.MathUtils.degToRad(A),direction:F,aspect:i._width/i._height}),M()},onUpdate:function(t){var e=t.amount;i._transitionEffect.updateUniforms({amount:e,aspect:i._width/i._height}),E()}});case mt.Slide:var V=O.onStart,L=O.onUpdate,G=k,N=G.slides,q=void 0===N?1:N,X=G.intensity,Y=void 0===X?1:X,Z=G.samples,H=void 0===Z?32:Z,Q=G.direction,$=void 0===Q?vt.Right:Q;return xt(xt({},O),{},{onStart:function(){i._setTransitionEffect(_t,{slides:q,intensity:Y,samples:H,direction:$}),V()},onUpdate:function(t){var e=t.amount,n=i._transitionEffect.getUniforms().amount;i._transitionEffect.updateUniforms({prevAmount:n,amount:e}),L()}});case mt.Blur:var J=O.onStart,K=O.onUpdate,tt=k,et=tt.intensity,nt=void 0===et?1:et,it=tt.samples,ot=void 0===it?32:it;return xt(xt({},O),{},{onStart:function(){i._setTransitionEffect(gt,{intensity:nt,samples:ot}),J()},onUpdate:function(t){var e=t.amount,n=i._transitionEffect.getUniforms().amount;i._transitionEffect.updateUniforms({prevAmount:n,amount:e}),K()}});case mt.Glitch:var rt=O.onStart,st=O.onUpdate,at=k,ut=at.seed,ft=void 0===ut?Math.random():ut;return xt(xt({},O),{},{onStart:function(){i._setTransitionEffect(W,{seed:ft,resolution:new a.Vector2(i._width,i._height)}),rt()},onUpdate:function(t){var e=t.amount;i._transitionEffect.getUniforms().resolution.set(i._width,i._height),i._transitionEffect.updateUniforms({amount:e}),st()}});default:return O}}},{key:"render",value:function(t,e,n){this.isTransitioning()&&(this._prevBackground.render(t,this._buffer),this._transitionEffect.render(t,this.renderToScreen?null:e,this._buffer,n))}},{key:"dispose",value:function(){this._transition.stop(),this._prevBackground.dispose(),this._buffer.dispose(),this._transitionEffect.dispose()}}]),f}(z.Pass),St=["onStart"];function Ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ot(){return f.WEBGL.isWebGLAvailable()}function Pt(t){return new Promise((function(e,n){(new a.TextureLoader).load(t,(function(t){t.wrapS=a.ClampToEdgeWrapping,t.wrapT=a.ClampToEdgeWrapping,t.minFilter=a.LinearFilter,t.repeat.set(1,1),e(t)}),(function(){return{}}),(function(t){var e;return n(null!==(e=t.error)&&void 0!==e?e:new Error("Failed to load requested image. Verify CORS policy or check if the image is valid."))}))}))}var Dt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t),s(this,"_renderer",void 0),s(this,"_composer",void 0),s(this,"_background",void 0),s(this,"_backgroundPass",void 0),s(this,"_transitionPass",void 0),s(this,"_effectPass",void 0),s(this,"_clock",new a.Clock(!1)),s(this,"_paused",!1),s(this,"_disposed",!1);var o=e.clientWidth,r=e.clientHeight;this._renderer=new a.WebGLRenderer({canvas:e,powerPreference:"high-performance"}),this._renderer.setSize(o,r,!1),this._composer=new u.EffectComposer(this._renderer),this._background=new lt(null,o,r),this._backgroundPass=new dt(this._background),this._transitionPass=new wt(this._background,o,r),this._effectPass=new st(o,r),this._composer.addPass(this._backgroundPass),this._composer.addPass(this._transitionPass),this._composer.addPass(this._effectPass),this._render=this._render.bind(this);var f=n.autoRender,c=void 0===f||f;c&&this.render()}return r(t,[{key:"effects",get:function(){return this._effectPass}},{key:"background",get:function(){return this._background}},{key:"isTransitioning",value:function(){return this._transitionPass.isTransitioning()}},{key:"setBackground",value:function(t,e){var i=this,o=this._renderer.domElement,r=o.clientWidth,s=o.clientHeight;if(this._background=new lt(t,r,s),e){var a=e.type,u=e.config,f=u.onStart,c=void 0===f?function(){return{}}:f,l=n(u,St);this._transitionPass.transition(this._background,a,kt(kt({},l),{},{onStart:function(t,e){i._backgroundPass.setBackground(e),c(t,e)}}))}else this._backgroundPass.setBackground(this._background),this._transitionPass.transition(this._background,mt.None)}},{key:"_resizeCanvas",value:function(){var t=this._renderer.domElement,e=t.width,n=t.height,i=t.clientWidth,o=t.clientHeight;e===i&&n===o||(this._renderer.setSize(i,o,!1),this._composer.setSize(i,o),this._backgroundPass.setSize(i,o),this._transitionPass.setSize(i,o),this._effectPass.setSize(i,o))}},{key:"render",value:function(){this._paused=!1,this._clock.start(),this._render()}},{key:"pause",value:function(){this._paused=!0,this._clock.stop()}},{key:"_render",value:function(){y(),this._resizeCanvas(),this._disposed||this._paused||(this._composer.render(this._clock.getDelta()),requestAnimationFrame(this._render))}},{key:"dispose",value:function(){this._disposed=!0,this._renderer.dispose(),this._backgroundPass.dispose(),this._transitionPass.dispose(),this._effectPass.dispose(),this._clock.stop()}}]),t}(),Tt=l;exports.midori=e})();
//# sourceMappingURL=midori.cjs.map